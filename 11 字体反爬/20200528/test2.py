#--coding:

import requests

from copyheaders import headers_raw_to_dict

import parsel
import re
import pprint

cc_url= 'http://s3plus.meituan.net/v1/mss_0a06a471f9514fc79c981b5466f56b91/svgtextcss/0459b8acc4f8ab52744631cbdbd26ef4.svg'
#
# res = requests.get(cc_url).text

res=''
with  open('bb_rt.html','r') as f:

    res=f.read()








#
index = re.findall('<path id="(\d+)" d="M0 (\d+) H\d+"/>',res)



print(index)

values = re.findall('">(.*?)</textPath>',res)
print(list(values[0]))
values =[list(values[v]) for v in range(len(values))]
print(values)

def getvalue(posXY,index,values):

    #找到在第几行
    xindex=0
    for yindex in range(len(index)):
        if posXY[1]<= int(index[yindex][1]):
            xindex = int(index[yindex][0])
            break
    #找到具体的位置

    value= values[xindex-1]

    xyindex = int(posXY[0]/14)
    return value[xyindex]




html_content = ''

with open('dazhong1.html','r') as f:
    html_content = f.read()


selector = parsel.Selector(html_content)

dic={
 'bb': {'rt': {'rt03h': (448.0, 87.0),
               'rt0dm': (112.0, 159.0),
               'rt0ff': (280.0, 87.0),
               'rt0j3': (308.0, 187.0),
               'rt0ny': (112.0, 261.0),
               'rt119': (252.0, 222.0),
               'rt11b': (210.0, 222.0),
               'rt17d': (448.0, 159.0),
               'rt1ts': (420.0, 222.0),
               'rt1z1': (56.0, 23.0),
               'rt25z': (434.0, 117.0),
               'rt2vc': (168.0, 159.0),
               'rt35e': (126.0, 87.0),
               'rt38d': (322.0, 222.0),
               'rt3aj': (364.0, 117.0),
               'rt3kd': (378.0, 87.0),
               'rt3mm': (252.0, 23.0),
               'rt3qc': (196.0, 187.0),
               'rt439': (140.0, 23.0),
               'rt45t': (210.0, 60.0),
               'rt48s': (350.0, 159.0),
               'rt4ag': (28.0, 60.0),
               'rt4b0': (14.0, 117.0),
               'rt4nr': (84.0, 261.0),
               'rt4w4': (266.0, 222.0),
               'rt50u': (126.0, 117.0),
               'rt53a': (154.0, 117.0),
               'rt54o': (392.0, 159.0),
               'rt5i9': (210.0, 159.0),
               'rt5ic': (0.0, 23.0),
               'rt5je': (504.0, 187.0),
               'rt5kb': (0.0, 117.0),
               'rt5l2': (490.0, 159.0),
               'rt5p4': (280.0, 117.0),
               'rt5wb': (392.0, 187.0),
               'rt5x1': (0.0, 87.0),
               'rt5zm': (266.0, 187.0),
               'rt61j': (322.0, 187.0),
               'rt6gw': (210.0, 87.0),
               'rt6i7': (434.0, 222.0),
               'rt6zg': (154.0, 23.0),
               'rt79x': (154.0, 222.0),
               'rt7c7': (140.0, 87.0),
               'rt7nz': (490.0, 87.0),
               'rt8hv': (238.0, 23.0),
               'rt8o8': (56.0, 117.0),
               'rt8q8': (560.0, 87.0),
               'rt8ug': (350.0, 117.0),
               'rt958': (420.0, 159.0),
               'rt9ab': (0.0, 159.0),
               'rt9e6': (252.0, 87.0),
               'rt9xt': (210.0, 187.0),
               'rt9yo': (14.0, 187.0),
               'rt9z0': (126.0, 159.0),
               'rta07': (252.0, 117.0),
               'rta6j': (56.0, 222.0),
               'rtabe': (140.0, 187.0),
               'rtacy': (224.0, 60.0),
               'rtama': (420.0, 117.0),
               'rtani': (532.0, 87.0),
               'rtapb': (154.0, 87.0),
               'rtar9': (364.0, 187.0),
               'rtb0q': (546.0, 187.0),
               'rtb6q': (266.0, 60.0),
               'rtb78': (14.0, 222.0),
               'rtba6': (42.0, 159.0),
               'rtblj': (336.0, 117.0),
               'rtbrp': (210.0, 23.0),
               'rtbrr': (168.0, 23.0),
               'rtc10': (224.0, 222.0),
               'rtc40': (196.0, 222.0),
               'rtce3': (154.0, 187.0),
               'rtceq': (28.0, 23.0),
               'rtcvg': (154.0, 60.0),
               'rtcwa': (126.0, 222.0),
               'rtcym': (350.0, 222.0),
               'rtd0r': (14.0, 87.0),
               'rtd8b': (28.0, 117.0),
               'rtdft': (42.0, 261.0),
               'rtdg8': (322.0, 117.0),
               'rtds6': (210.0, 117.0),
               'rtdv9': (266.0, 87.0),
               'rte68': (238.0, 222.0),
               'rtean': (98.0, 261.0),
               'rteb0': (140.0, 159.0),
               'rteci': (434.0, 159.0),
               'rtem6': (238.0, 187.0),
               'rtes4': (294.0, 222.0),
               'rtev2': (294.0, 23.0),
               'rtex1': (56.0, 87.0),
               'rteyr': (238.0, 117.0),
               'rtf1b': (14.0, 23.0),
               'rtf2c': (518.0, 187.0),
               'rtf97': (42.0, 87.0),
               'rtf9s': (126.0, 23.0),
               'rtfkd': (392.0, 222.0),
               'rtfor': (238.0, 159.0),
               'rtfva': (252.0, 60.0),
               'rtfwl': (378.0, 222.0),
               'rtfxy': (70.0, 60.0),
               'rtg56': (462.0, 187.0),
               'rtggu': (14.0, 261.0),
               'rtgi6': (434.0, 187.0),
               'rtgno': (126.0, 261.0),
               'rtgnv': (266.0, 23.0),
               'rtgpv': (504.0, 87.0),
               'rtgr6': (280.0, 159.0),
               'rtgrp': (490.0, 187.0),
               'rtgu6': (98.0, 23.0),
               'rtguq': (224.0, 187.0),
               'rtgv7': (154.0, 159.0),
               'rtgwd': (140.0, 261.0),
               'rth5m': (364.0, 87.0),
               'rth66': (224.0, 23.0),
               'rth6t': (126.0, 187.0),
               'rthey': (42.0, 117.0),
               'rthgo': (168.0, 187.0),
               'rti0r': (112.0, 87.0),
               'rti7w': (140.0, 222.0),
               'rtiha': (140.0, 117.0),
               'rtihe': (406.0, 117.0),
               'rtij1': (406.0, 159.0),
               'rtiut': (182.0, 159.0),
               'rtiy6': (0.0, 222.0),
               'rtizi': (70.0, 261.0),
               'rtj2t': (84.0, 187.0),
               'rtj3a': (168.0, 222.0),
               'rtj43': (294.0, 187.0),
               'rtj87': (462.0, 87.0),
               'rtje1': (476.0, 87.0),
               'rtjek': (168.0, 117.0),
               'rtjm8': (266.0, 117.0),
               'rtjmg': (294.0, 159.0),
               'rtjn0': (280.0, 222.0),
               'rtjri': (168.0, 261.0),
               'rtjsj': (546.0, 87.0),
               'rtjsw': (56.0, 60.0),
               'rtk12': (14.0, 60.0),
               'rtk5h': (462.0, 159.0),
               'rtk5z': (98.0, 187.0),
               'rtkcr': (112.0, 60.0),
               'rtkk6': (0.0, 261.0),
               'rtkkj': (56.0, 187.0),
               'rtkmb': (280.0, 187.0),
               'rtkpt': (294.0, 117.0),
               'rtks9': (56.0, 261.0),
               'rtl0t': (28.0, 159.0),
               'rtl8e': (378.0, 159.0),
               'rtl8m': (182.0, 187.0),
               'rtlxf': (350.0, 87.0),
               'rtm0b': (0.0, 187.0),
               'rtm32': (56.0, 159.0),
               'rtm5x': (518.0, 87.0),
               'rtm79': (196.0, 159.0),
               'rtmej': (112.0, 23.0),
               'rtmf5': (0.0, 60.0),
               'rtmru': (224.0, 117.0),
               'rtmyx': (406.0, 87.0),
               'rtn5b': (196.0, 117.0),
               'rtn6e': (308.0, 23.0),
               'rtn8p': (322.0, 23.0),
               'rtn96': (252.0, 159.0),
               'rto20': (42.0, 187.0),
               'rto6n': (266.0, 159.0),
               'rtoe3': (112.0, 187.0),
               'rtoh2': (532.0, 187.0),
               'rtoho': (420.0, 87.0),
               'rtosv': (224.0, 87.0),
               'rtozh': (504.0, 159.0),
               'rtp2e': (196.0, 60.0),
               'rtp4m': (112.0, 222.0),
               'rtp6t': (14.0, 159.0),
               'rtpne': (518.0, 159.0),
               'rtpvi': (70.0, 87.0),
               'rtpvw': (364.0, 222.0),
               'rtpwf': (98.0, 87.0),
               'rtpwv': (28.0, 187.0),
               'rtq01': (252.0, 187.0),
               'rtq3i': (238.0, 60.0),
               'rtq3s': (336.0, 159.0),
               'rtq4v': (112.0, 117.0),
               'rtqex': (182.0, 261.0),
               'rtqgg': (182.0, 117.0),
               'rtqjw': (378.0, 117.0),
               'rtqya': (84.0, 159.0),
               'rtqyk': (98.0, 222.0),
               'rtr55': (70.0, 159.0),
               'rtr7w': (406.0, 222.0),
               'rtr8k': (308.0, 222.0),
               'rtrao': (224.0, 159.0),
               'rtrc2': (336.0, 87.0),
               'rtrh8': (98.0, 159.0),
               'rts2w': (308.0, 87.0),
               'rts7y': (294.0, 87.0),
               'rts96': (392.0, 117.0),
               'rtsb9': (126.0, 60.0),
               'rtsfg': (322.0, 159.0),
               'rtsn3': (476.0, 159.0),
               'rtt60': (364.0, 159.0),
               'rttb6': (28.0, 261.0),
               'rttkt': (336.0, 187.0),
               'rttmj': (182.0, 60.0),
               'rtu2k': (238.0, 87.0),
               'rtu48': (322.0, 87.0),
               'rtudm': (574.0, 87.0),
               'rtuh4': (84.0, 222.0),
               'rtuh5': (98.0, 117.0),
               'rtuhw': (182.0, 87.0),
               'rtuku': (84.0, 60.0),
               'rtutu': (420.0, 187.0),
               'rtv05': (140.0, 60.0),
               'rtv42': (434.0, 87.0),
               'rtvp4': (42.0, 60.0),
               'rtvvl': (196.0, 87.0),
               'rtvw6': (378.0, 187.0),
               'rtvy5': (448.0, 187.0),
               'rtwhb': (196.0, 261.0),
               'rtwl6': (294.0, 60.0),
               'rtwox': (336.0, 222.0),
               'rtwp4': (70.0, 117.0),
               'rtwp5': (168.0, 60.0),
               'rtwwp': (168.0, 87.0),
               'rtwy3': (98.0, 60.0),
               'rtx1g': (70.0, 187.0),
               'rtxg8': (84.0, 87.0),
               'rtxjy': (154.0, 261.0),
               'rtxrr': (476.0, 187.0),
               'rtxw6': (308.0, 117.0),
               'rtxzc': (392.0, 87.0),
               'rty0k': (280.0, 60.0),
               'rty3h': (196.0, 23.0),
               'rty6t': (42.0, 23.0),
               'rty8e': (84.0, 23.0),
               'rtydz': (70.0, 222.0),
               'rtyln': (42.0, 222.0),
               'rtyw9': (350.0, 187.0),
               'rtyxd': (406.0, 187.0),
               'rtyz2': (280.0, 23.0),
               'rtz8p': (182.0, 23.0),
               'rtzch': (308.0, 159.0),
               'rtzdi': (28.0, 87.0),
               'rtzk3': (84.0, 117.0),
               'rtzla': (70.0, 23.0),
               'rtzp9': (182.0, 222.0),
               'rtzqq': (560.0, 187.0),
               'rtzy4': (28.0, 222.0)},
        'url': 'http://s3plus.meituan.net/v1/mss_0a06a471f9514fc79c981b5466f56b91/svgtextcss/9ab05bba0c97c641c3fd8e79db2e6b61.svg'}
}

# bb = selector.css('.address-info bb::attr(class)').getall()

bb = re.findall('<bb class="(.*?)"></bb>',html_content)

num=''
for b in bb:

    pos = dic.get('bb',{}).get('rt',{}).get(b)

    posxy=(float(pos[0]),float(pos[1]))
    key =getvalue(posxy,index,values)
    html_content = html_content.replace('<bb class="'+b+'"></bb>',key)
    num+=str(key)


with open('da3.html','w') as f:
    f.write(html_content)



